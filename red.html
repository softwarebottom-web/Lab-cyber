<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <title>RED_OPS | COMMAND_CENTER</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body { background: #000; color: #ff0000; font-family: 'JetBrains Mono', monospace; overflow: hidden; }
        .red-border { border: 1px solid #ff0000; box-shadow: 0 0 15px rgba(255, 0, 0, 0.2); }
        .btn-strike { background: #600; color: white; transition: 0.3s; font-weight: 900; }
        .btn-strike:hover { background: #f00; box-shadow: 0 0 20px #f00; color: black; }
        .console-text { font-size: 10px; line-height: 1.2; }
    </style>
</head>
<body class="h-screen flex flex-col p-6">
    <header class="flex justify-between items-center border-b-2 border-red-600 pb-4 mb-6">
        <h1 class="text-3xl font-black italic tracking-tighter">RED_<span class="text-white">STRIKE_UNIT</span></h1>
        <div class="flex gap-4">
            <span class="text-[10px] bg-red-900 px-3 py-1 animate-pulse">SYSTEM_ONLINE: NODES_ACTIVE</span>
            <button onclick="location.href='lab.html'" class="text-[10px] underline hover:text-white">RETURN_TO_BASE</button>
        </div>
    </header>

    <div class="grid grid-cols-12 gap-6 flex-1 overflow-hidden">
        <aside class="col-span-3 space-y-4">
            <div class="red-border p-4 bg-zinc-950">
                <label class="text-[10px] font-bold text-gray-500 uppercase">Target_Identifier</label>
                <input type="text" id="target" placeholder="Domain or IP" class="w-full bg-black border border-red-900 p-3 text-xs mt-2 outline-none focus:border-red-500 text-red-500">
            </div>

            <div class="red-border p-4 bg-zinc-950">
                <label class="text-[10px] font-bold text-gray-500 uppercase">Attack_Method</label>
                <select id="method" class="w-full bg-black border border-red-900 p-3 text-xs mt-2 outline-none text-red-500">
                    <option value="L4_UDP_FLOOD">LAYER_4_UDP_FLOOD</option>
                    <option value="L7_BYPASS">LAYER_7_WAF_BYPASS</option>
                    <option value="TCP_STRIKE">TCP_SYN_STRIKE</option>
                    <option value="SLOW_STORM">SLOWLORIS_STORM</option>
                </select>
                <button onclick="startAttack()" class="btn-strike w-full py-4 mt-4 text-xs uppercase tracking-widest">Execute_Strike</button>
            </div>

            <div class="red-border p-4 bg-zinc-900/20">
                <h3 class="text-[10px] font-black text-blue-500 mb-4 uppercase">Cyber_Police_Module</h3>
                <button onclick="triggerPolice()" class="w-full border border-blue-600 text-blue-500 py-3 text-[10px] font-bold hover:bg-blue-600 hover:text-white transition">EXECUTE_POLICE_BOT</button>
                <p class="text-[8px] text-gray-600 mt-2 italic">*Forensics, IP Tracing, & Criminal Reporting</p>
            </div>
        </aside>

        <main class="col-span-9 flex flex-col gap-4 overflow-hidden">
            <div class="flex-1 red-border bg-black p-6 overflow-y-auto console-text relative">
                <div class="absolute top-2 right-4 text-red-900 font-bold uppercase opacity-30">Live_Attack_Monitor</div>
                <div id="terminal" class="space-y-1">
                    <p class="text-white">[#] Red Team Terminal v3.0 Init...</p>
                </div>
            </div>

            <div class="h-40 red-border bg-zinc-950 p-4 flex gap-6">
                <div class="flex-1 border-r border-red-900/30">
                    <h4 class="text-[10px] font-bold text-red-500 uppercase mb-2">Target_Intelligence</h4>
                    <div id="intel" class="text-[10px] text-gray-500 space-y-1">
                        <p>ISP: <span id="isp">-</span></p>
                        <p>Location: <span id="loc">-</span></p>
                        <p>Org: <span id="org">-</span></p>
                    </div>
                </div>
                <div class="w-1/3 flex flex-col justify-center items-center">
                    <p class="text-[9px] text-gray-600 mb-2 font-bold uppercase">Strike_Power</p>
                    <div class="w-full bg-red-900/20 h-2 rounded-full overflow-hidden">
                        <div class="bg-red-600 h-full animate-pulse" style="width: 85%"></div>
                    </div>
                </div>
            </div>
        </main>
    </div>

    <script type="module">
        import { BACKEND_URL } from "./auth-system.js";

        const term = document.getElementById('terminal');

        window.startAttack = async () => {
            const target = document.getElementById('target').value;
            const method = document.getElementById('method').value;
            if(!target) return alert("Enter Target!");

            term.innerHTML += `<p class="text-yellow-500">[!] Commencing ${method} on ${target}...</p>`;
            
            try {
                const res = await fetch(`${BACKEND_URL}/strike`, {
                    method: 'POST',
                    headers: {'Content-Type': 'application/json'},
                    body: JSON.stringify({ target, method })
                });
                const data = await res.json();
                term.innerHTML += `<p class="text-green-500">[+] Attack Status: ${data.message}</p>`;
            } catch (e) {
                term.innerHTML += `<p class="text-red-500">[X] Backend Offline.</p>`;
            }
        };

        window.triggerPolice = async () => {
            const target = document.getElementById('target').value;
            if(!target) return alert("Target IP/Domain Required!");

            term.innerHTML += `<p class="text-blue-500">[*] Police Bot: Deploying Forensic Unit to ${target}...</p>`;
            
            try {
                const res = await fetch(`${BACKEND_URL}/police-report`, {
                    method: 'POST',
                    headers: {'Content-Type': 'application/json'},
                    body: JSON.stringify({ ip: target })
                });
                const data = await res.json();
                term.innerHTML += `<p class="text-blue-400">[!] Police Bot: ${data.message}</p>`;
                
                // Update Intel
                document.getElementById('isp').innerText = data.forensics.isp;
                document.getElementById('loc').innerText = data.forensics.city + ", " + data.forensics.country;
                document.getElementById('org').innerText = data.forensics.org;
            } catch (e) { alert("Police Bot Error!"); }
        };
    </script>
</body>
</html>
